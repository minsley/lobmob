---
status: draft
tags: [ui, infrastructure, lobboss]
maturity: design
created: 2026-02-15
updated: 2026-02-16
---
# Task Flow Improvements

## Summary

Improve the task creation and tracking experience with web-based task entry and better visibility into task lifecycle. The lobboss web dashboard (port 8080) is the natural home for a task management UI, starting with creation and expanding to list/edit/filter over time. Authentication and WAN access are out of scope — handled separately.

## Open Questions

- [x] Task creation form: should submitting also trigger lobboss to pick it up immediately (webhook/event), or rely on the existing poll cycle? **Resolved: shorten poll cycle for near-instant pickup. Direct trigger deferred to vault scaling work**
- [x] Task list: how much vault state to expose? **Resolved: active by default, completed/failed tabs limited to last 30 days or 50 entries**
- [x] Edit capability: which fields should be editable after creation? **Resolved: Phase 1-2 are read-only after creation. Phase 3 adds cancel/re-open actions; once in a cancellable/editable state, all fields except ID and system-managed fields (assignee, etc.) are editable**
- [x] Naming for non-task jobs: **Resolved: pool jobs = `lobster-pool-{type}-{n}`, reserve jobs = `lobster-reserve-{type}-{name|slug}`**

## Current State

### Task IDs
- Current format: `task-YYYY-MM-DD-4hex` (e.g. `task-2026-02-15-a1b2`)
- Generated by lobboss when creating task files in the vault
- Used as the canonical identifier everywhere: vault filename, k8s job labels, Discord threads, PRs
- **Changing**: [vault scaling plan](../active/vault-scaling.md) introduces sequential IDs via SQLite autoincrement: `T1`, `T2`, `T42`. Date and slug become metadata fields. Task creation goes through lobwife API, which returns the new ID

### K8s Job Names
- Already use task ID: `lobster-{type}-{task-id}`, sanitized to 63 chars via `_sanitize_k8s_name()`
- Current: `lobster-swe-task-2026-02-15-a1b2`. New: `lobster-swe-t42` (shorter, cleaner)
- Implemented in `src/lobboss/mcp_tools.py:129`

### Task Entry
- Primary: Discord message in #task-queue, lobboss creates the task
- Secondary: Manual vault file creation (used for system tasks, testing)
- No web UI for task entry
- **Changing**: [vault scaling plan](../active/vault-scaling.md) Phase 2 moves task creation to lobwife API (POST `/api/v1/tasks`). lobboss calls API for metadata/ID, then writes vault file for body content

## Phases

### Phase 1: Web task creation form

- **Status**: pending
- **Depends on**: [vault scaling](../active/vault-scaling.md) Phase 2 (task CRUD API on lobwife)
- Add a task creation page/tab to the lobboss web dashboard (`scripts/server/lobmob-web.js`, port 8080)
- Form fields: description (text area), type (swe/research/qa dropdown), priority (optional), target repos (optional, comma-separated), name (optional display name)
- Submit action: POST to lobwife `/api/v1/tasks` (returns sequential ID like `T42`), then write vault file with body content
- Task poller queries API for queued tasks — near-instant pickup without poll cycle shortening
- Cluster-internal access only (port-forward). No authentication layer in this phase

### Phase 2: Task list view

- **Status**: pending
- **Depends on**: [vault scaling](../active/vault-scaling.md) Phase 2 (task API provides fast queries)
- Read-only task list on the lobboss web dashboard
- Show: task ID (`T42`), display name, type, status, assigned lobster (job name), PR links, created/updated timestamps
- Source data from lobwife API (`GET /api/v1/tasks`) — fast indexed queries replace vault file parsing
- Default view: active tasks. Tabs for completed and failed, limited to last 30 days or 50 entries
- Link each task to its Discord thread and GitHub PRs

### Phase 3: Task actions and editing

- **Status**: pending
- Add cancel action: PATCH `/api/v1/tasks/{id}` with status=cancelled, clean up associated state (kill running lobster job, close draft PRs if any)
- Add re-open action: PATCH status=queued for a cancelled or failed task
- Once cancelled or re-opened, all fields are editable except: task ID, and system-managed fields (assignee, assigned_at, completed_at, etc.)
- Edits go through lobwife API (PATCH), vault file updated by sync daemon
- Audit trail via `task_events` table: logs who/what modified the task (web UI vs. Discord vs. system)

### Phase 4: Filtering, querying, bulk operations (stretch)

- **Status**: pending
- Search and filter by status, type, date range, assigned lobster, repo — all via lobwife API query params
- Bulk actions: cancel all queued, re-queue selected failed tasks (batch PATCH calls)
- Task statistics: completion rate, average duration by type, cost per task — from `task_events` and `cost_events` tables
- This phase may overlap with or be superseded by [vault scaling](../active/vault-scaling.md) Phase 6 Obsidian Dataview dashboards

## Decisions Log

| Date | Decision | Rationale |
|------|----------|-----------|
| 2026-02-15 | Keep date-based task IDs as-is (pre-DB) | Natural sort order, no coordination needed for uniqueness, already well-integrated |
| 2026-02-15 | K8s job naming already uses task ID | `lobster-{type}-{task-id}` is already readable. No changes needed |
| 2026-02-15 | Skip task short-codes for now (pre-DB) | Low task volume doesn't justify the counter coordination complexity |
| 2026-02-16 | Sequential task IDs (T1, T2...) via vault scaling DB | SQLite autoincrement solves coordination. Shorter IDs for k8s jobs, Discord threads, web UI. See [vault scaling](../active/vault-scaling.md) |
| 2026-02-16 | Task creation via lobwife API + vault file | API returns sequential ID, lobboss writes vault file with body content. Replaces direct vault-only creation |
| 2026-02-15 | Web UI lives on lobboss dashboard | lobboss is the task creator and coordinator — natural home |
| 2026-02-15 | Authentication out of scope | WAN access, login, and cluster ingress are a separate concern |
| 2026-02-15 | Shorten poll cycle instead of direct trigger | Simpler, avoids coupling web UI to lobboss internals. **Superseded**: task poller queries lobwife API directly once vault scaling Phase 2 is complete |
| 2026-02-15 | No editing in Phases 1-2, cancel/re-open in Phase 3 | Keep early phases simple. Editing only makes sense after cancel/re-open gives you a safe state to edit in |
| 2026-02-15 | Job naming: pool = `lobster-pool-{type}-{n}`, reserve = `lobster-reserve-{type}-{name}` | Visually distinct from task jobs, consistent prefix pattern for kubectl filtering |

## Scratch

- Could add a task search/filter to the web UI (by status, type, date range)
- Discord thread names could include a task display name instead of just the ID
- Consider a task URL scheme that deep-links to the web dashboard
- The lobboss web dashboard currently shows fleet status — task entry would be a natural second tab
- Job naming convention decided:
  - Task: `lobster-{type}-{task-id}` (current)
  - Pool: `lobster-pool-{type}-{n}` (e.g. `lobster-pool-swe-01`)
  - Reserve: `lobster-reserve-{type}-{name|slug}` (user-provided name or generated slug, e.g. `lobster-reserve-swe-debug-vault`)
- Reserve creation UI (web or CLI) should have a name field, default-populated with a generated slug from the description

## Related

- [Roadmap](../roadmap.md)
- [Scratch Sheet](../planning-scratch-sheet.md)
- [Discord UX](./discord-ux.md) — Task notifications and thread naming
- [Vault Scaling](../active/vault-scaling.md) — Sequential task IDs (T1, T2...), task CRUD API, DB-backed state
